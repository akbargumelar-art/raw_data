
# Deployment Guide for Ubuntu VPS

**Repository:** https://github.com/akbargumelar-art/raw_data.git
**Target Path:** /var/www/raw
**Domain:** raw.abkciraya.cloud
**Port:** 6002

## 1. Environment Setup (One-time)

Access your VPS via SSH:
```bash
# Update System
sudo apt update && sudo apt upgrade -y

# Install Node.js 18, Git, Nginx
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt-get install -y nodejs git nginx

# Install PM2
sudo npm install -g pm2
```

## 2. Clone Project

```bash
# Create directory
sudo mkdir -p /var/www/raw
sudo chown -R $USER:$USER /var/www/raw
cd /var/www/raw

# Clone your specific repository
git clone https://github.com/akbargumelar-art/raw_data.git .
```

## 3. Build & Install

```bash
# Install dependencies
npm install

# Build React Frontend (Output goes to /dist)
npm run build
```

## 4. Production Configuration (.env)

Create the secret environment file:
```bash
nano .env
```

**PASTE THIS CONTENT:**
```env
# Database Credentials
DB_HOST=agrabudi.com
DB_USER=akbar
DB_PASS=Ciraya@555
DB_PORT=52306
DB_NAME=akbar

# App Config
APP_PORT=6002
JWT_SECRET=super_secret_key_change_me
```

## 5. Start Application

```bash
# Start with PM2
pm2 start server/server.js --name "dataflow-pro"

# Ensure it restarts on reboot
pm2 save
pm2 startup
```

## 6. Nginx Configuration

```bash
sudo nano /etc/nginx/sites-available/raw.abkciraya.cloud
```

**PASTE THIS CONTENT:**
```nginx
server {
    listen 80;
    server_name raw.abkciraya.cloud;

    location / {
        proxy_pass http://localhost:6002;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

**ACTIVATE:**
```bash
sudo ln -s /etc/nginx/sites-available/raw.abkciraya.cloud /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

## 7. SSL Certificate

```bash
sudo apt install certbot python3-certbot-nginx -y
sudo certbot --nginx -d raw.abkciraya.cloud
```

## Updating the App (Future)

When you push changes to GitHub, run this on VPS:
```bash
cd /var/www/raw
git pull origin main
npm install
npm run build
pm2 restart dataflow-pro
```
